module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},8591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(72131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},92434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},68063,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},43108,a=>{"use strict";let b=(0,a.i(70106).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],43108)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},1065,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(64193),f=a.i(38246),g=a.i(210),h=a.i(70106);let i=(0,h.default)("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]),j=(0,h.default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),k=(0,h.default)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var l=a.i(43108);function m(){let a=(0,d.useParams)(),h=(0,d.useRouter)(),m=a.studentId,[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)({}),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(!1),D=(0,c.useRef)(null),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1);async function I(){u(!0);let{data:a}=await e.supabase.from("students").select("*").eq("id",m).single();a&&(o(a),a.is_locked&&C(!0));let{data:b}=await e.supabase.from("criteria").select("*").order("id",{ascending:!0});b&&q(b);let c=localStorage.getItem("access_key");if(c){let{data:a}=await e.supabase.from("scores").select("*").eq("student_id",m).eq("judge_id",c);if(a&&a.length>0){let b={};a.forEach(a=>{b[a.criteria_id]=a.score}),s(b)}}u(!1),setTimeout(L,500)}(0,c.useEffect)(()=>{let a=localStorage.getItem("user_role"),b=localStorage.getItem("access_key");"jury"===a&&b?(A(b),m&&I()):h.push("/")},[m]);let J=(0,c.useRef)(null),K=async(a,b=!1)=>{if(B)return;let c=localStorage.getItem("access_key");if(!c)return;let d=p.map(b=>{let d=a[b.id]||0,e=b.max_score||100;return d>e&&(d=e),d<0&&(d=0),{student_id:m,criteria_id:b.id,judge_id:c,score:d,judge_name:localStorage.getItem("user_name")||"Juri"}}),{error:f}=await e.supabase.from("scores").upsert(d,{onConflict:"student_id,criteria_id,judge_id"});f?console.error("Autosave failed",f):y(new Date),w(!1)};function L(){let a=D.current;if(a){let b=a.getContext("2d");b&&(b.lineWidth=2,b.lineCap="round",b.strokeStyle="#000")}}let M=a=>{if(B)return;let b=D.current;if(!b)return;let c=b.getContext("2d");if(!c)return;F(!0),H(!0);let d=b.getBoundingClientRect(),e=(a.clientX||a.touches[0].clientX)-d.left,f=(a.clientY||a.touches[0].clientY)-d.top;c.beginPath(),c.moveTo(e,f)},N=a=>{if(!E||B)return;let b=D.current;if(!b)return;let c=b.getContext("2d"),d=b.getBoundingClientRect(),e=(a.clientX||a.touches[0].clientX)-d.left,f=(a.clientY||a.touches[0].clientY)-d.top;c.lineTo(e,f),c.stroke()},O=()=>F(!1);return t?(0,b.jsx)("div",{className:"p-12 text-center text-gray-500",children:"Initializing Assessment..."}):n?(0,b.jsxs)("main",{className:"dashboard-container bg-gray-50 min-h-screen pb-20",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4 sticky top-0 bg-gray-50 z-20 py-4 shadow-sm md:shadow-none",children:[(0,b.jsxs)(f.default,{href:"/jury",className:"flex items-center gap-2 text-gray-500 hover:text-blue-600 transition-colors font-medium",children:[(0,b.jsx)(g.ArrowLeft,{size:20})," ",(0,b.jsx)("span",{className:"hidden md:inline",children:"Back to List"})]}),(0,b.jsx)("div",{className:"flex items-center gap-3 bg-white px-4 py-2 rounded-full shadow-sm border border-gray-100",children:v?(0,b.jsxs)("span",{className:"flex items-center gap-2 text-blue-600 text-sm font-bold animate-pulse",children:[(0,b.jsx)(k,{size:16})," Saving..."]}):x?(0,b.jsxs)("span",{className:"flex items-center gap-2 text-green-600 text-sm font-bold",children:[(0,b.jsx)(j,{size:16})," Saved ",x.toLocaleTimeString()]}):(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:"Ready to score"})})]}),(0,b.jsxs)("div",{className:"premium-card bg-gradient-to-r from-indigo-900 to-blue-800 text-white border-none shadow-xl mb-8 relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-10",children:(0,b.jsx)(i,{size:120})}),(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:n.name}),(0,b.jsxs)("p",{className:"text-blue-200 text-lg flex items-center gap-2 mb-4",children:[(0,b.jsx)("span",{className:"bg-blue-700/50 px-3 py-1 rounded-lg border border-blue-500/30",children:n.class}),(0,b.jsxs)("span",{className:"opacity-70",children:["#",n.id]})]}),B?(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 bg-red-500/20 text-red-100 border border-red-500/50 px-4 py-2 rounded-lg font-bold",children:[(0,b.jsx)(l.Lock,{size:18})," ASSESSMENT LOCKED (READ-ONLY)"]}):(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 bg-green-500/20 text-green-100 border border-green-500/50 px-4 py-2 rounded-lg font-bold",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})," Live Scoring Active"]})]})]}),(0,b.jsxs)("div",{className:"space-y-6 max-w-4xl mx-auto",children:[p.map((a,c)=>(0,b.jsx)("div",{className:`premium-card transition-all ${r[a.id]?"border-l-4 border-l-green-500":"border-l-4 border-l-gray-300"}`,children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsxs)("span",{className:"bg-gray-100 text-gray-600 text-xs font-bold px-2 py-1 rounded uppercase tracking-wider",children:["Criteria ",c+1]}),a.weight&&1!==a.weight&&(0,b.jsxs)("span",{className:"bg-blue-50 text-blue-600 text-xs font-bold px-2 py-1 rounded",children:["Bobot: ",a.weight,"x"]})]}),(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-800 leading-snug",children:a.name}),(0,b.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:["Max Score: ",a.max_score]})]}),(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"number",inputMode:"numeric",disabled:B,value:r[a.id]||"",onChange:b=>((a,b)=>{if(B)return;let c=parseInt(b);isNaN(c)&&(c=0);let d=p.find(b=>b.id===a),e=d?d.max_score:100;c>e&&(c=e),c<0&&(c=0);let f={...r,[a]:c};s(f),w(!0),J.current&&clearTimeout(J.current),J.current=setTimeout(async()=>{await K(f,!0)},1e3)})(a.id,b.target.value),className:`w-28 text-center text-4xl font-bold rounded-2xl p-3 outline-none transition-all shadow-sm border-2 ${B?"bg-gray-100 text-gray-400 border-gray-200":r[a.id]?"border-blue-500 text-blue-600 bg-white ring-4 ring-blue-50/50":"border-gray-200 text-gray-700 bg-gray-50 focus:bg-white focus:border-blue-500"}`,placeholder:"0"}),(0,b.jsxs)("span",{className:"absolute top-2 right-2 text-[10px] font-bold text-gray-300",children:["/ ",a.max_score]})]})})]})},a.id)),(0,b.jsxs)("div",{className:"premium-card bg-white mt-8",children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,b.jsx)(i,{className:"text-gray-600"})," Validator Signature"]}),(0,b.jsxs)("div",{className:`border-2 border-dashed rounded-xl relative h-48 w-full touch-none overflow-hidden transition-colors ${B?"bg-gray-100 border-gray-200 opacity-75":"bg-gray-50 border-gray-300 hover:border-blue-300"}`,children:[(0,b.jsx)("canvas",{ref:D,width:600,height:192,className:`w-full h-full ${B?"cursor-not-allowed":"cursor-crosshair"}`,onMouseDown:M,onMouseMove:N,onMouseUp:O,onMouseLeave:O,onTouchStart:M,onTouchMove:N,onTouchEnd:O}),!G&&!B&&(0,b.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-400 pointer-events-none",children:[(0,b.jsx)(i,{size:32,className:"mb-2 opacity-20"}),(0,b.jsx)("span",{className:"text-sm",children:"Sign here to validate"})]}),B&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-red-400/50 font-bold text-2xl -rotate-12 select-none",children:"LOCKED"})]}),!B&&(0,b.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,b.jsx)("p",{className:"text-xs text-gray-400",children:"Signature is required for final submission."}),(0,b.jsx)("button",{onClick:()=>{if(B)return;let a=D.current;a&&(a.getContext("2d").clearRect(0,0,a.width,a.height),H(!1))},className:"text-sm text-red-500 hover:text-red-600 font-medium px-3 py-1 hover:bg-red-50 rounded-lg transition-colors",children:"Clear Signature"})]})]}),!B&&(0,b.jsxs)("div",{className:"pt-6 pb-12",children:[(0,b.jsxs)("button",{onClick:()=>h.push("/jury"),className:"btn-primary w-full py-5 text-xl shadow-xl hover:shadow-2xl hover:scale-[1.01] active:scale-[0.99] transition-all bg-gray-900 border border-gray-800",children:[(0,b.jsx)(j,{className:"inline mr-2"})," Finish Assessment"]}),(0,b.jsx)("p",{className:"text-center text-gray-400 text-sm mt-4",children:"All scores are automatically saved. You can return later."})]})]})]}):(0,b.jsx)("div",{className:"p-12 text-center text-red-500",children:"Student not found"})}a.s(["default",()=>m],1065)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6ad22fbf._.js.map