module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},8591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(72131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},92434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},68063,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},43108,a=>{"use strict";let b=(0,a.i(70106).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],43108)},15305,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(64193),f=a.i(38246),g=a.i(70106);let h=(0,g.default)("Gavel",[["path",{d:"m14 13-7.5 7.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L11 10",key:"c9cbz0"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]),i=(0,g.default)("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);var j=a.i(43108);let k=(0,g.default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),l=(0,g.default)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);function m(){let a=(0,d.useRouter)(),[g,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)({}),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)(!1);async function H(){E(!0);let{data:a}=await e.supabase.from("students").select("*").order("name",{ascending:!0}),{data:b}=await e.supabase.from("events").select("*");b&&o(b);let{data:c}=await e.supabase.from("event_criteria").select("*");a&&m(a),c&&u(c),E(!1)}(0,c.useEffect)(()=>{"Juri"!==localStorage.getItem("user_role")?a.push("/"):H()},[a]);let I=async a=>{let b=g.find(b=>b.id===a);if(!b)return;s(b),w({}),y(""),G(!1);let{data:c}=await e.supabase.from("scores").select("*").eq("student_id",b.id),d=!1;if(c){let a={};c.forEach(b=>{a[b.criteria_id]=b.score,b.is_final&&(d=!0)}),w(a)}A(d)},J=()=>{if(!r||0===t.length)return{total:0,average:0};let a=0,b=0;t.filter(a=>!p||a.event_id==p).forEach(c=>{let d=v[c.id]||0,e=Number(c.weight||0);a+=d*e,b+=e});let c=Math.min(100,Math.max(0,b>0?a/b:0));return{total:a,average:c,totalWeight:b}},K=async(a=!1)=>{if(!r)return void alert("Pilih siswa terlebih dahulu!");G(!0);try{let b=Object.keys(v).map(a=>{let b=v[a];return a&&void 0!==b?{student_id:r.id,criteria_id:a,score:b}:null}).filter(a=>null!==a);if(b.length>0){let{error:a}=await e.supabase.from("scores").upsert(b);if(a)throw a}let c=J();if(a){let a={is_final:!0,average_score:c.average},b=r.event_id||p;b&&(a.event_id=b);let{error:d}=await e.supabase.from("scores").update(a).eq("student_id",r.id);d?(console.warn("Update Error:",d.message),alert(`Gagal mengunci: ${d.message}.`)):(console.log("Data tersimpan di Database: scores",a),A(!0),alert("Data Berhasil Dikunci dan Dikirim ke Koordinator!"),H())}else alert("Draft nilai tersimpan.")}catch(a){alert("Error: "+a.message)}finally{G(!1)}};return(0,b.jsxs)("main",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,b.jsxs)("div",{className:"bg-white shadow-sm border-b px-6 py-4 flex justify-between items-center sticky top-0 z-20",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-purple-600 p-2 rounded-lg text-white",children:(0,b.jsx)(h,{size:20})}),(0,b.jsxs)("h1",{className:"font-bold text-gray-800 text-lg",children:["Juri",(0,b.jsx)("span",{className:"text-purple-600",children:"Room"})]})]}),(0,b.jsx)(f.default,{href:"/",className:"text-sm font-medium text-gray-500 hover:text-red-500",children:"Exit"})]}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Pilih Lomba / Kompetensi"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-100 transition-all appearance-none bg-white",onChange:a=>{q(a.target.value),s(null)},value:p,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Lomba --"}),n.map(a=>(0,b.jsx)("option",{value:a.id,children:a.event_name},a.id))]}),(0,b.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400",children:"▼"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Pilih Peserta Ujian"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-100 transition-all appearance-none bg-white",onChange:a=>I(a.target.value),value:r?.id||"",disabled:!p,children:[(0,b.jsx)("option",{value:"",children:"-- Pilih Siswa --"}),g.filter(a=>!p||a.event_id==p).map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," - ",a.class]},a.id))]}),(0,b.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400",children:"▼"})]})]})]}),r?(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,b.jsx)("div",{className:"md:col-span-2 space-y-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 bg-purple-50 border-b border-purple-100 flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"font-bold text-purple-800",children:"Form Penilaian"}),z&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs font-bold bg-green-100 text-green-700 px-2 py-1 rounded-md",children:[(0,b.jsx)(j.Lock,{size:12})," TERKUNCI"]})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[t.filter(a=>!p||a.event_id==p).map(a=>(0,b.jsxs)("div",{className:"pb-4 border-b border-gray-50 last:border-0 last:pb-0",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("label",{className:"font-semibold text-gray-700 text-sm",children:a.criteria_name}),(0,b.jsxs)("span",{className:"text-xs font-bold text-purple-500 bg-purple-50 px-2 py-0.5 rounded",children:["Bobot: ",a.weight||0]})]}),(0,b.jsx)("input",{type:"number",placeholder:"0-100",min:"0",max:"100",disabled:z,value:v[a.id]||"",onChange:b=>((a,b)=>{if(z)return;let c=b;c<0&&(c=0),c>100&&(c=100),w(b=>({...b,[a]:c}))})(a.id,parseFloat(b.target.value)),className:`w-full px-4 py-3 rounded-xl border outline-none transition-all block text-lg font-mono
                                                    ${z?"bg-gray-50 text-gray-400 border-gray-100":"border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-50"}`})]},a.id)),0===t.filter(a=>!p||a.event_id==p).length&&(0,b.jsx)("p",{className:"text-center text-gray-400 italic",children:"Belum ada kriteria untuk lomba ini."}),(0,b.jsxs)("div",{className:"pt-4",children:[(0,b.jsx)("label",{className:"font-semibold text-gray-700 text-sm mb-2 block",children:"Catatan Juri (Opsional)"}),(0,b.jsx)("textarea",{rows:3,disabled:z,value:x,onChange:a=>y(a.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 outline-none focus:border-purple-500 transition-all text-sm",placeholder:"Berikan masukan untuk siswa..."})]})]})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-purple-600 to-indigo-700 rounded-2xl p-6 text-white shadow-xl shadow-purple-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 opacity-80 mb-2",children:[(0,b.jsx)(l,{size:18}),(0,b.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Hasil Penilaian"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-sm opacity-75",children:"Nilai Akhir"}),(0,b.jsxs)("div",{className:"text-5xl font-bold tracking-tight",children:[J().average.toFixed(2),(0,b.jsx)("span",{className:"text-2xl opacity-50 font-normal",children:"/100"})]}),(0,b.jsx)("span",{className:"text-[10px] opacity-60 italic",children:"Rumus: (Total Poin Berbobot / Total Bobot)"}),(0,b.jsx)("div",{className:"h-px bg-white/20 my-2"}),(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm font-medium",children:[(0,b.jsx)("span",{children:"Status"}),(0,b.jsx)("span",{className:"bg-white/20 px-2 py-0.5 rounded text-xs",children:z?"TERKUNCI":"DRAFT"})]})]})]}),z?(0,b.jsxs)("button",{disabled:!0,className:"w-full bg-gray-100 text-gray-400 font-bold py-4 rounded-xl flex items-center justify-center gap-2 cursor-not-allowed",children:[(0,b.jsx)(j.Lock,{size:18}),"Nilai Terkunci"]}):(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,b.jsxs)("button",{onClick:()=>K(!1),disabled:F,className:"py-3 px-4 rounded-xl font-bold text-purple-600 bg-white border border-purple-200 hover:bg-purple-50 transition-all flex items-center justify-center gap-2",children:[(0,b.jsx)(k,{size:18})," Simpan Draft"]}),(0,b.jsxs)("button",{onClick:()=>K(!0),className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-200 transition-all flex items-center justify-center gap-2",children:[(0,b.jsx)(j.Lock,{size:18}),"Selesai Nilai (Final)"]})]})]})]}):(0,b.jsxs)("div",{className:"text-center py-20 text-gray-400",children:[(0,b.jsx)(i,{size:48,className:"mx-auto mb-4 opacity-20"}),(0,b.jsx)("p",{children:"Silakan pilih siswa untuk mulai menilai."})]})]})]})}a.s(["default",()=>m],15305)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__aafa774d._.js.map